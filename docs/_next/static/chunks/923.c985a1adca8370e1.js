!function(){var t={4051:function(t){var n=function(t){"use strict";var n,r=Object.prototype,e=r.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,n,r,e){var i=n&&n.prototype instanceof d?n:d,o=Object.create(i.prototype),a=new S(e||[]);return o._invoke=function(t,n,r){var e=c;return function(i,o){if(e===l)throw new Error("Generator is already running");if(e===y){if("throw"===i)throw o;return O()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=I(a,r);if(s){if(s===p)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(e===c)throw e=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);e=l;var u=h(t,n,r);if("normal"===u.type){if(e=r.done?y:f,u.arg===p)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(e=y,r.method="throw",r.arg=u.arg)}}}(t,r,a),o}function h(t,n,r){try{return{type:"normal",arg:t.call(n,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var c="suspendedStart",f="suspendedYield",l="executing",y="completed",p={};function d(){}function v(){}function g(){}var w={};w[o]=function(){return this};var x=Object.getPrototypeOf,m=x&&x(x(T([])));m&&m!==r&&e.call(m,o)&&(w=m);var b=g.prototype=d.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(n){t[n]=function(t){return this._invoke(n,t)}}))}function z(t,n){function r(i,o,a,s){var u=h(t[i],t,o);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"===typeof f&&e.call(f,"__await")?n.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):n.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;this._invoke=function(t,e){function o(){return new n((function(n,i){r(t,e,n,i)}))}return i=i?i.then(o,o):o()}}function I(t,r){var e=t.iterator[r.method];if(e===n){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=n,I(t,r),"throw"===r.method))return p;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var i=h(e,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,p;var o=i.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=n),r.delegate=null,p):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function L(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function D(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function T(t){if(t){var r=t[o];if(r)return r.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(e.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=n,r.done=!0,r};return a.next=a}}return{next:O}}function O(){return{value:n,done:!0}}return v.prototype=b.constructor=g,g.constructor=v,g[s]=v.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var n="function"===typeof t&&t.constructor;return!!n&&(n===v||"GeneratorFunction"===(n.displayName||n.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},E(z.prototype),z.prototype[a]=function(){return this},t.AsyncIterator=z,t.async=function(n,r,e,i,o){void 0===o&&(o=Promise);var a=new z(u(n,r,e,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(b),b[s]="Generator",b[o]=function(){return this},b.toString=function(){return"[object Generator]"},t.keys=function(t){var n=[];for(var r in t)n.push(r);return n.reverse(),function r(){for(;n.length;){var e=n.pop();if(e in t)return r.value=e,r.done=!1,r}return r.done=!0,r}},t.values=T,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(D),!t)for(var r in this)"t"===r.charAt(0)&&e.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(e,i){return s.type="throw",s.arg=t,r.next=e,i&&(r.method="next",r.arg=n),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=e.call(a,"catchLoc"),h=e.call(a,"finallyLoc");if(u&&h){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&e.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=n&&n<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=n,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(a)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),p},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),p}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var e=r.completion;if("throw"===e.type){var i=e.arg;D(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,e){return this.delegate={iterator:T(t),resultName:r,nextLoc:e},"next"===this.method&&(this.arg=n),p}},t}(t.exports);try{regeneratorRuntime=n}catch(r){Function("r","regeneratorRuntime = r")(n)}}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var o=n[e]={exports:{}},a=!0;try{t[e](o,o.exports,r),a=!1}finally{a&&delete n[e]}return o.exports}r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,{a:n}),n},r.d=function(t,n){for(var e in n)r.o(n,e)&&!r.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:n[e]})},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)};!function(){"use strict";var t=r(4051),n=r.n(t);var e=function(){function t(n,r,e){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=n,this.y=r,this.z=e}var n=t.prototype;return n.getAbsoluteVector=function(){return new t(Math.abs(this.x),Math.abs(this.y),Math.abs(this.z))},n.getDirectionVector=function(){return new t(0===this.x?0:Math.abs(this.x)/this.x,0===this.y?0:Math.abs(this.y)/this.y,0===this.z?0:Math.abs(this.z)/this.z)},n.getLongest=function(){var t=this.getAbsoluteVector();return t.x>t.y&&t.x>t.z?"x":t.y>t.z&&t.y>t.x?"y":"z"},n.getLength=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},n.getNormal=function(){var n=this.getLength();return new t(this.x/n,this.y/n,this.z/n)},n.multiply=function(n){return new t(this.x*n,this.y*n,this.z*n)},n.add=function(n){return new t(this.x+n.x,this.y+n.y,this.z+n.z)},n.subtract=function(n){return new t(this.x-n.x,this.y-n.y,this.z-n.z)},n.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))},n.ceil=function(){return new t(Math.ceil(this.x),Math.ceil(this.y),Math.ceil(this.z))},n.clone=function(){return new t(this.x,this.y,this.z)},n.addMutate=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},n.subtractMutate=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},n.cloneFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},n.multiplyMutate=function(t){return this.x*=t,this.y*=t,this.z*=t,this},n.floorMutate=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},n.scalarProduct=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},n.toString=function(){return"{x:".concat(this.x,",y:").concat(this.y,",z:").concat(this.z,"}")},n.serialize=function(){return JSON.stringify({x:this.x,y:this.y,z:this.z})},t}();var i=function(){function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.api=n,this.transformContainer=new this.api.btTransform}var n=t.prototype;return n.bodyToBodyInfo=function(t){t.getMotionState().getWorldTransform(this.transformContainer);var n=this.transformContainer.getOrigin(),r=this.transformContainer.getRotation();return{id:t.getUserIndex(),x:n.x(),y:n.y(),z:n.z(),quaternionX:r.x(),quaternionY:r.y(),quaternionZ:r.z(),quaternionW:r.w()}},n.extractIntoBodyInfo=function(t,n){t.getMotionState().getWorldTransform(this.transformContainer);var r=this.transformContainer.getOrigin(),e=this.transformContainer.getRotation();n.id=t.getUserIndex(),n.x=r.x(),n.y=r.y(),n.z=r.z(),n.quaternionX=e.x(),n.quaternionY=e.y(),n.quaternionZ=e.z(),n.quaternionW=e.w()},t}();function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var a,s=function(){function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9.82;o(this,t),this.nextId=0,this.shouldStop=!1,this.subscribers=[],this.bodies=[],this.bodyInfo=[],this.api=n,this.bodyParser=new i(n),this.collisionConfiguration=new n.btDefaultCollisionConfiguration,this.dispatcher=new n.btCollisionDispatcher(this.collisionConfiguration),this.overlappingPairCache=new n.btDbvtBroadphase,this.solver=new n.btSequentialImpulseConstraintSolver,this.world=new n.btDiscreteDynamicsWorld(this.dispatcher,this.overlappingPairCache,this.solver,this.collisionConfiguration),this.world.setGravity(new n.btVector3(0,-1*r,0))}var n=t.prototype;return n.generateNewId=function(){var t=this.nextId;return this.nextId=t+1,t},n.getQuaternion=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.api,e=t?new r.btVector3(t.x,t.y,t.z):new r.btVector3(0,1,0),i=new r.btQuaternion(0,0,0,1);return i.setRotation(e,n),i},n.addBox=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=this.api,s=new a.btBoxShape(new this.api.btVector3(t.x/2,t.y/2,t.z/2)),u=new a.btTransform;u.setIdentity(),u.setOrigin(new a.btVector3(n.x,n.y,n.z));var h=this.getQuaternion(i||new e(0,1,0),o);u.setRotation(h);var c=new a.btVector3(0,0,0),f=new a.btDefaultMotionState(u),l=new a.btRigidBodyConstructionInfo(r,f,s,c),y=new a.btRigidBody(l),p=this.generateNewId();return y.setUserIndex(p),this.world.addRigidBody(y),this.bodies.push(y),this.bodyInfo.push(this.bodyParser.bodyToBodyInfo(y)),y},n.sendUpdate=function(){var t=this;this.bodies.forEach((function(n,r){t.bodyParser.extractIntoBodyInfo(n,t.bodyInfo[r])})),this.subscribers.forEach((function(n){return n(t.bodyInfo)}))},n.start=function(){var t=this;this.shouldStop=!1;var n=1/60,r=Date.now()-16.666666666666668,e=function(i){var o;if(!t.shouldStop){requestAnimationFrame(e);var a=(i-r)/1e3;null===(o=t.world)||void 0===o||o.stepSimulation(n,a),t.sendUpdate(),r=i}};e(r+16.666666666666668)},n.destroy=function(){this.shouldStop=!0,this.api.destroy(this.world),this.api.destroy(this.solver),this.api.destroy(this.overlappingPairCache),this.api.destroy(this.dispatcher),this.api.destroy(this.collisionConfiguration)},n.subscribe=function(t){this.subscribers.push(t)},t}();function u(t,n,r,e,i,o,a){try{var s=t[o](a),u=s.value}catch(h){return void r(h)}s.done?n(u):Promise.resolve(u).then(e,i)}!function(t){t.INITIALIZED="INITIALIZED",t.STARTED="STARTED",t.DESTROYED="DESTROYED",t.BOX_ADDED="BOX_ADDED"}(a||(a={})),importScripts("../../../ammo.wasm.js");var h={locateFile:function(){return"../../../ammo.wasm.wasm"}},c=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t);var r=this;addEventListener("message",function(){var t,i=(t=n().mark((function t(i){var o,s,u,h,c,f,l,y,p,d,v,g,w,x,m;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=i.data,t.t0=o.type,t.next="INITIALIZE"===t.t0?4:"START"===t.t0?9:"DESTROY"===t.t0?13:"ADD_BOX"===t.t0?17:27;break;case 4:return t.next=6,r.initEngine();case 6:return s={type:a.INITIALIZED,payload:void 0},postMessage(s),t.abrupt("break",28);case 9:return r.start(),u={type:a.STARTED,payload:void 0},postMessage(u),t.abrupt("break",28);case 13:return r.destroy(),h={type:a.DESTROYED,payload:void 0},postMessage(h),t.abrupt("break",28);case 17:if(r.engine){t.next=19;break}return t.abrupt("return");case 19:return c=o.payload,f=c.dimensions,l=c.position,y=c.mass,p=c.rotationAxis,d=c.angle,v=JSON.parse(f),g=JSON.parse(l),w=p?JSON.parse(p):void 0,x=r.engine.addBox(new e(v.x,v.y,v.z),new e(g.x,g.y,g.z),y,w?new e(w.x,w.y,w.z):void 0,d),m={type:a.BOX_ADDED,payload:{id:null===x||void 0===x?void 0:x.getUserIndex()}},postMessage(m),t.abrupt("break",28);case 27:return t.abrupt("break",28);case 28:case"end":return t.stop()}}),t)})),function(){var n=this,r=arguments;return new Promise((function(e,i){var o=t.apply(n,r);function a(t){u(o,e,i,a,s,"next",t)}function s(t){u(o,e,i,a,s,"throw",t)}a(void 0)}))});return function(t){return i.apply(this,arguments)}}())}var r=t.prototype;return r.onUpdate=function(t){postMessage({type:"BODIES_UPDATE",payload:t})},r.initEngine=function(){if(!this.engine){var t=this;return Ammo(h).then((function(n){var r=t;t.engine=new s(n),t.engine.subscribe((function(t){r.onUpdate(t)}))}))}return Promise.resolve()},r.start=function(){var t;null===(t=this.engine)||void 0===t||t.start()},r.destroy=function(){var t;null===(t=this.engine)||void 0===t||t.destroy()},t}();new c}(),_N_E={}}();