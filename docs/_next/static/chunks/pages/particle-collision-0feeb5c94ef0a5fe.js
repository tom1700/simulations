(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[285],{997:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/particle-collision",function(){return t(4920)}])},4920:function(n,e,t){"use strict";t.r(e);var i=t(5893),r=t(6447),a=t(7507),o=t(3321),s=t(7294),l=t(1125),u=t(9477),c=t(7995),d=t(3255),p=t(8861),w=t(3493),h=t.n(w);var f=function(){function n(e,t,i){!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.shouldStop=!1,this.worldSize=e,this.particlesAmount=t,this.onFPSUpdate=i}var e=n.prototype;return e.startAnimation=function(n){var e=this,t=function(n,e){var t=new l.World;t.gravity.set(0,-9.82,0);var i=new Array(e).fill(0).map((function(){var n=new l.Body({mass:1,position:new l.Vec3((0,d.i)(-5,5),(0,d.i)(-5,5),(0,d.i)(-5,5)),shape:new l.Sphere(1)});return t.addBody(n),n})),r=new l.Material("stone"),a=new l.Plane,o=new l.Body({mass:0,material:r});o.addShape(a),o.quaternion.setFromAxisAngle(new l.Vec3(1,0,0),-Math.PI/2),o.position.set(0,-n/2,0),t.addBody(o);var s=new l.Plane,u=new l.Body({mass:0,material:r});u.addShape(s),u.quaternion.setFromAxisAngle(new l.Vec3(1,0,0),Math.PI/2),u.position.set(0,n/2,0),t.addBody(u);var c=new l.Plane,p=new l.Body({mass:0,material:r});p.addShape(c),p.quaternion.setFromAxisAngle(new l.Vec3(0,1,0),Math.PI/2),p.position.set(-n/2,0,0),t.addBody(p);var w=new l.Plane,h=new l.Body({mass:0,material:r});h.addShape(w),h.quaternion.setFromAxisAngle(new l.Vec3(0,1,0),-Math.PI/2),h.position.set(n/2,0,0),t.addBody(h);var f=new l.Plane,m=new l.Body({mass:0,material:r});m.addShape(f),m.position.set(0,0,-n/2),t.addBody(m);var y=new l.Plane,v=new l.Body({mass:0,material:r});return v.addShape(y),v.quaternion.setFromAxisAngle(new l.Vec3(0,1,0),Math.PI),v.position.set(0,0,n/2),t.addBody(v),{world:t,particles:i}}(this.worldSize,this.particlesAmount),i=t.world,r=t.particles,a=(0,c.Y)(n,this.worldSize),o=a.scene,s=a.render,p=a.removeScene,w=r.map((function(n){var e=new u.xo$(1),t=new u.vBJ({color:16711680}),i=new u.Kj0(e,t);return i.position.set(n.position.x,n.position.y,n.position.z),o.add(i),{sphere:i,particle:n}})),h=Date.now(),f=function(){if(e.shouldStop)p();else{var n=Date.now();e.onFPSUpdate(1e3/(n-h)),h=n,requestAnimationFrame(f),i.step(.016666666666666666),w.forEach((function(n){var e,t,i=n.sphere;t=n.particle,(e=i).position.x=t.position.x,e.position.y=t.position.y,e.position.z=t.position.z,e.quaternion.x=t.quaternion.x,e.quaternion.y=t.quaternion.y,e.quaternion.z=t.quaternion.z,e.quaternion.w=t.quaternion.w})),s()}};f()},e.stopAnimation=function(){this.shouldStop=!0},n}();e.default=function(){var n=(0,s.useRef)(),e=(0,s.useRef)(null),t=(0,s.useRef)(null),l=(0,s.useState)(10),u=l[0],c=l[1],d=(0,s.useState)(10),w=d[0],m=d[1],y=(0,s.useCallback)((function(){if(n.current&&n.current.stopAnimation(),e.current){n.current=new f(u,w,h()((function(n){t.current&&(t.current.innerText=n.toFixed(0))}),1e3)),n.current.startAnimation(e.current)}}),[w,u]);return(0,i.jsx)(p.T,{title:"Particle simulation with collisions",subtitle:"This time I'm using cannon.js for a proper physics simulation",backLink:"/particle-gravity",backLabel:"< Particle Gravity",forwardLink:"/particle-collision-with-worker",forwardLabel:"Particle Collision Web Worker >",children:(0,i.jsxs)(r.Z,{spacing:2,direction:"row",style:{flex:1},children:[(0,i.jsx)("div",{style:{flex:2},ref:e}),(0,i.jsxs)(r.Z,{spacing:2,style:{flex:1},children:["World Size: ",u,(0,i.jsx)(a.ZP,{min:10,max:100,step:1,value:u,onChange:function(n,e){return!Array.isArray(e)&&c(e)}}),"Particles Amount: ",w,(0,i.jsx)(a.ZP,{min:10,max:2e3,step:1,value:w,onChange:function(n,e){return!Array.isArray(e)&&m(e)}}),(0,i.jsxs)("div",{children:["FPS: ",(0,i.jsx)("span",{ref:t,children:"0"})]}),(0,i.jsx)(o.Z,{onClick:y,children:"Simulate"})]})]})})}},3255:function(n,e,t){"use strict";t.d(e,{i:function(){return i}});var i=function(n,e){return Math.random()*(e-n)+n}}},function(n){n.O(0,[737,526,543,321,507,365,731,774,888,179],(function(){return e=997,n(n.s=e);var e}));var e=n.O();_N_E=e}]);